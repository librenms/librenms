mib: 'IF-MIB:NMS-SYS-MIB:NMS-OPTICAL-MIB'
modules:
    os:
        hardware:
            - 'ENTITY-MIB::entPhysicalModelName.1'
        version:
            - 'ENTITY-MIB::entPhysicalSoftwareRev.1'
        serial:
            - 'ENTITY-MIB::entPhysicalSerialNum.1'
    sensors:
        additional_oids:
            data:
                - oid:
                        - ifName
        temperature:
            data:
                -   
                    oid: temperatureTable
                    value: temperatureValue
                    num_oid: '.1.3.6.1.4.1.56166.1.2.4.1.2.{{ $index }}'
                    descr: 'Temperature {{ $index }}'
                - 
                    oid: opticalModuleInfoTable
                    value: opticalTemperature
                    num_oid: '.1.3.6.1.4.1.56166.1.8.2.1.10.{{ $index }}'
                    descr: '{{ $ifName }} Transceiver Temperature'
                    low_limit: opticalTempLoAlarm
                    low_warn_limit: opticalTempLoWarn
                    high_limit: opticalTempHiAlarm
                    warn_limit: opticalTempHiWarn
                    entPhysicalIndex: '{{ $index }}'
                    entPhysicalIndex_measured: ports
                    index: 'opticalTemperature-{{ $index }}'
                    group: transceiver
                    skip_values:
                        - 
                            oid: opticalSupportDDM
                            op: '!='
                            value: '1'
        state:
            data:
                - 
                    oid: powerTable
                    value: powerState
                    num_oid: '.1.3.6.1.4.1.56166.1.2.3.1.3.{{ $index }}'
                    descr: 'Power {{ $index }} state'
                    states:
                        - { descr: 'on', graph: 1, value: 1, generic: 0 }
                        - { descr: 'off', graph: 2, value: 2, generic: 2 }
                -   
                    oid: fanStatusTable
                    value: fanStatus
                    num_oid: '.1.3.6.1.4.1.56166.1.2.5.1.3.{{ $index }}'
                    descr: 'Fan {{ $index }} status'
                    state_name: 'NMS-SYS-MIB::fanStatus'
                    states:
                        - { descr: normal, graph: 1, value: 1, generic: 0 }
                        - { descr: failure, graph: 0, value: 2, generic: 2 }
                - 
                    oid: fanStatusTable
                    value: fanSpeedStatus
                    num_oid: '.1.3.6.1.4.1.56166.1.2.5.1.2.{{ $index }}'
                    descr: 'Fan {{ $index }} speed'
                    state_name: fanSpeedStatus
                    states:
                        - { descr: unknown, graph: 0, value: 0, generic: 2 }
                        - { descr: low, graph: 1, value: 1, generic: 0 }
                        - { descr: medium, graph: 2, value: 2, generic: 0 }
                        - { descr: high, graph: 3, value: 3, generic: 0 }
        dbm:
            data:
                - 
                    oid: opticalModuleInfoTable
                    value: opticalRxPower
                    num_oid: '.1.3.6.1.4.1.56166.1.8.2.1.13.{{ $index }}'
                    descr: '{{ $ifName }} Transceiver Receive Power'
                    divisor: 100
                    low_limit: opticalRxLoAlarm
                    low_warn_limit: opticalRxLoWarn
                    high_limit: opticalRxHiAlarm
                    warn_limit: opticalRxHiWarn
                    entPhysicalIndex: '{{ $index }}'
                    entPhysicalIndex_measured: ports
                    index: 'opticalRxPower-{{ $index }}'
                    group: transceiver
                    skip_values:
                        - 
                            oid: opticalSupportDDM
                            op: '!='
                            value: '1'
                - 
                    oid: opticalModuleInfoTable
                    value: opticalTxPower
                    num_oid: '.1.3.6.1.4.1.56166.1.8.2.1.14.{{ $index }}'
                    descr: '{{ $ifName }} Transceiver Transmit Power'
                    divisor: 100
                    low_limit: opticalTxLoAlarm
                    low_warn_limit: opticalTxLoWarn
                    high_limit: opticalTxHiAlarm
                    warn_limit: opticalTxHiWarn
                    entPhysicalIndex: '{{ $index }}'
                    entPhysicalIndex_measured: ports
                    index: 'opticalTxPower-{{ $index }}'
                    group: transceiver
                    skip_values:
                        - 
                            oid: opticalSupportDDM
                            op: '!='
                            value: '1'
        current:
            data:
                - 
                    oid: opticalModuleInfoTable
                    value: opticalBiasCurrent
                    num_oid: '.1.3.6.1.4.1.56166.1.8.2.1.12.{{ $index }}'
                    descr: '{{ $ifName }} Transceiver Bias Current'
                    divisor: 100000
                    low_limit: opticalBiasLoAlarm
                    low_warn_limit: opticalBiasLoWarn
                    high_limit: opticalBiasHiAlarm
                    warn_limit: opticalBiasHiWarn
                    entPhysicalIndex: '{{ $index }}'
                    entPhysicalIndex_measured: ports
                    index: 'opticalBiasCurrent-{{ $index }}'
                    group: transceiver
                    skip_values:
                        - 
                            oid: opticalSupportDDM
                            op: '!='
                            value: '1'
        voltage:
            data:
                -
                    oid: opticalModuleInfoTable
                    value: opticalVoltage
                    num_oid: '.1.3.6.1.4.1.56166.1.8.2.1.11.{{ $index }}'
                    descr: '{{ $ifName }} Transceiver Voltage'
                    divisor: 100
                    low_limit: opticalVoltLoAlarm
                    low_warn_limit: opticalVoltLoWarn
                    high_limit: opticalVoltHiAlarm
                    warn_limit: opticalVoltHiWarn
                    entPhysicalIndex: '{{ $index }}'
                    entPhysicalIndex_measured: ports
                    index: 'opticalVoltage-{{ $index }}'
                    group: transceiver
                    skip_values:
                        - 
                            oid: opticalSupportDDM
                            op: '!='
                            value: '1'
