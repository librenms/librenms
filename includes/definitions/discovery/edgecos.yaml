mib: EDGECORE-MIB:EDGECORE-ENTITY-MIB:EDGECORE-SYSTEM-MIB
modules:
  os:
    sysDescr_regex: '/\((?<hardware>[^)]+) (?<version>[A-Za-z0-9.-]+)/'
    hardware:
      - EDGECORE-ENTITY-MIB::ecEntityHardwareName
      - ENTITY-MIB::entPhysicalName
    serial:
      - EDGECORE-ENTITY-MIB::ecEntitySerialNumber
      - ENTITY-MIB::entPhysicalSerialNum

  processors:
    data:
      - oid: ecProcessorTable
        value: ecProcessorUsage
        num_oid: '.1.3.6.1.4.1.259.10.1.2.1.5.{{ $index }}'
        descr: '{{ $entPhysicalName }} Processor'
        skip_values:
          - oid: ecProcessorState
            op: '!='
            value: 3

  sensors:
    temperature:
      data:
        - oid: ecTemperatureTable
          value: ecTemperatureValue
          num_oid: '.1.3.6.1.4.1.259.10.1.3.1.6.{{ $index }}'
          descr: '{{ $entPhysicalName }} Temperature'
          index: '{{ $index }}'
          entPhysicalIndex: '{{ $index }}'
          group: sensor
          skip_values:
            - oid: ecTemperatureValue
              op: '<'
              value: '-50'
            - oid: ecTemperatureValue
              op: '>='
              value: '2147483646'

    voltage:
      data:
        - oid: ecVoltageTable
          value: ecVoltageValue
          num_oid: '.1.3.6.1.4.1.259.10.1.4.1.6.{{ $index }}'
          descr: '{{ $entPhysicalName }} Voltage'
          index: '{{ $index }}'
          entPhysicalIndex: '{{ $index }}'
          group: sensor
          divisor: 1000
          skip_values:
            - oid: ecVoltageValue
              op: '='
              value: '-1'
            - oid: ecVoltageValue
              op: '='
              value: '-255'

    fanspeed:
      data:
        - oid: ecFanTable
          value: ecFanSpeed
          num_oid: '.1.3.6.1.4.1.259.10.1.5.1.7.{{ $index }}'
          descr: 'Fan {{ $subindex0 }} Speed'
          group: fan
          divisor: 1

    power:
      data:
        - oid: ecPowerTable
          value: ecPowerUsage
          num_oid: '.1.3.6.1.4.1.259.10.1.6.1.8.{{ $index }}'
          descr: '{{ $entPhysicalName }} Power'
          index: '{{ $index }}'
          group: power
          divisor: 1000

  dbm:
    data:
      - oid: edgeOpticalModuleInfoTable
        value: edgeEntityOpticalRxPower
        num_oid: '.1.3.6.1.4.1.259.10.1.1.3.1.8.{{ $index }}'
        descr: '{{ $entPhysicalName }} Rx'
        entPhysicalIndex: '{{ $index }}'
        entPhysicalIndex_measured: 'ports'
        group: transceiver
        index: 'rx-{{ $index }}'
        user_func: 'uw_to_dbm'
        low_limit: edgeEntityOpticalRxLowWarnThreshold
        high_limit: edgeEntityOpticalRxHighWarnThreshold
        skip_values:
          - oid: edgeEntityOpticalRxPower
            op: '<='
            value: 0
          - oid: edgeEntityAdminStatus
            op: '='
            value: 12

      - oid: edgeOpticalModuleInfoTable
        value: edgeEntityOpticalRxPower
        num_oid: '.1.3.6.1.4.1.259.10.1.1.3.1.8.{{ $index }}'
        descr: '{{ $entPhysicalName }} Rx'
        entPhysicalIndex: '{{ $index }}'
        entPhysicalIndex_measured: 'ports'
        group: transceiver
        index: 'rx-{{ $index }}'
        divisor: 100
        skip_values:
          - oid: edgeEntityOpticalRxPower
            op: '>'
            value: 0
          - oid: edgeEntityAdminStatus
            op: '='
            value: 12
          - oid: edgeEntityOpticalLaneRxPower
            op: 'exists'
            value: true
          - oid: edgeEntityOpticalBiasCurrent
            op: '='
            value: 0

      - oid: edgeOpticalModuleInfoTable
        value: edgeEntityOpticalTxPower
        num_oid: '.1.3.6.1.4.1.259.10.1.1.3.1.9.{{ $index }}'
        descr: '{{ $entPhysicalName }} Tx'
        entPhysicalIndex: '{{ $index }}'
        entPhysicalIndex_measured: 'ports'
        group: transceiver
        index: 'tx-{{ $index }}'
        user_func: 'uw_to_dbm'
        skip_values:
          - oid: edgeEntityOpticalTxPower
            op: '<='
            value: 0
          - oid: edgeEntityAdminStatus
            op: '='
            value: 12

      - oid: edgeOpticalModuleInfoTable
        value: edgeEntityOpticalTxPower
        num_oid: '.1.3.6.1.4.1.259.10.1.1.3.1.9.{{ $index }}'
        descr: '{{ $entPhysicalName }} Tx'
        entPhysicalIndex: '{{ $index }}'
        entPhysicalIndex_measured: 'ports'
        group: transceiver
        index: 'tx-{{ $index }}'
        divisor: 100
        skip_values:
          - oid: edgeEntityOpticalTxPower
            op: '>'
            value: 0
          - oid: edgeEntityAdminStatus
            op: '='
            value: 12
          - oid: edgeEntityOpticalLaneTxPower
            op: 'exists'
            value: true
          - oid: edgeEntityOpticalBiasCurrent
            op: '='
            value: 0

      - oid: edgeOpticalModuleInfoTable
        value: edgeEntityOpticalLaneRxPower
        num_oid: '.1.3.6.1.4.1.259.10.1.1.3.1.32.{{ $index }}'
        descr: '{{ $entPhysicalName }} Rx'
        entPhysicalIndex: '{{ $index }}'
        entPhysicalIndex_measured: 'ports'
        group: transceiver
        index: 'lane-rx-{{ $index }}'
        divisor: 100
        high_limit: edgeEntityOpticalRxHighThreshold
        low_limit: edgeEntityOpticalRxLowThreshold
        skip_values:
          - oid: edgeEntityOpticalRxPower
            op: '>'
            value: 0
          - oid: edgeEntityAdminStatus
            op: '='
            value: 12

      - oid: edgeOpticalModuleInfoTable
        value: edgeEntityOpticalLaneTxPower
        num_oid: '.1.3.6.1.4.1.259.10.1.1.3.1.33.{{ $index }}'
        descr: '{{ $entPhysicalName }} Tx'
        entPhysicalIndex: '{{ $index }}'
        entPhysicalIndex_measured: 'ports'
        group: transceiver
        index: 'lane-tx-{{ $index }}'
        high_limit: edgeEntityOpticalTxHighThreshold
        low_limit: edgeEntityOpticalTxLowThreshold
        skip_values:
          - oid: edgeEntityOpticalTxPower
            op: '>'
            value: 0
          - oid: edgeEntityAdminStatus
            op: '='
            value: 12
        divisor: 100
